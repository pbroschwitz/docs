---
description: Harvester API's event type endpoints for Data-In Persisters
---

# Data-In Persisters

## Paths

* GET /projects/{project-name}/event-types/{event-type-name}/eventstores/pg/persister
* PUT /projects/{project-name}/event-types/{event-type-name}/eventstores/pg/persister
* GET /projects/{project-name}/event-types/{event-type-name}/eventstores/pg/persister/state
* POST /projects/{project-name}/event-types/{event-type-name}/eventstores/pg/persister/state
* GET /projects/{project-name}/event-types/{event-type-name}/eventstores/pg/persister/logs

## API Methods

Consult the [Granary Access Clients Reference](../../../../operator-reference/identity-and-access-management/granary-access-clients.md#harvester-api) for roles a user needs to interact with Harvester API.



{% swagger baseUrl="https://api.grnry.io" path="/projects/:project-name/event-types/:event-type-name/eventstores/pg/persister" method="get" summary="Get Persister for a Specific Event Type" conflict="[object Object]" %}
{% swagger-description %}
Get the persister of a Data-in event type.

\


This request requires the role either 

`viewer`

or 

`editor`

.
{% endswagger-description %}

{% swagger-parameter in="path" name="project-name" type="string" required="false" %}
Name of project the event-type belongs to. 

\




_Backwards compatibility:_

 

\


If 

`projects/{project-name}/`

 is missing, URL will be treated like 

`projects/global/...`

 scoping the request to the 'global' project.
{% endswagger-parameter %}

{% swagger-parameter in="path" name="event-type-name" type="string" required="true" %}
Name of the event type.
{% endswagger-parameter %}

{% swagger-parameter in="header" name="Authentication" type="string" required="true" %}
Authentication token.
{% endswagger-parameter %}

{% swagger-parameter in="query" name="export" type="string" %}
if set to 

`"true"`

 (not case sensitive), the persister response will only contain properties that are not set to default values or generated by the api. Default is 

`""`

.
{% endswagger-parameter %}

{% swagger-parameter in="query" name="expand" type="string" %}
Expand the response with 

`state`

 to show the persister state. Default is 

`""`

.
{% endswagger-parameter %}

{% swagger-response status="200" description="requested :event-type-name (eventtype-1) , :event-store-name (pg)" %}
```
{
    "streamName": "grnry-p-pg-postman-eventtype-1",
    "projectName": "global",
    "appName": "grnry-eventstore-pg",
    "appVersion": "latest",
    "appConfig": {
        "eventstore.tablename": "public.eventstore",
        "spring.datasource.url": "jdbc:postgresql://host:5432/postgres?currentSchema=public",
        "spring.datasource.password": "${superuser-password}",
        "spring.datasource.username": "${superuser-username}",
        "spring.cloud.kubernetes.secrets.paths": "/usr/src/app/db-secret",
        "spring.cloud.stream.kafka.binder.autocreatetopics": "true",
        "spring.cloud.stream.kafka.binder.autoaddpartitions": "true",
        "spring.cloud.stream.kafka.binder.minpartitioncount": "24",
        "spring.cloud.stream.kafka.binder.replicationfactor": "3",
        "spring.cloud.stream.bindings.input.consumer.concurrency": "6",
        "spring.cloud.stream.bindings.input.consumer.partitioned": "true"
    },
    "deployerConfig": {
        "kubernetes.volumes": "[{name: 'secret', secret: { secretName : 'grnry-base-encryption-token' , defaultMode : '256' }}, {name: 'db-secret', secret: { secretName : 'grnry-pg-citus-secret' , defaultMode : '256' }}]",
        "kubernetes.limits.cpu": "500m",
        "kubernetes.requests.cpu": "500m",
        "kubernetes.volumemounts": "[{name: 'secret', mountPath: '/usr/src/app/rsa_privatekey.key' , subPath: 'rsa_privatekey.key' , readOnly : 'true' },{name: 'secret', mountPath: '/usr/src/app/rsa_publickey.key' , subPath: 'rsa_publickey.key' , readOnly : 'true' }, {name: 'db-secret', mountPath: '/usr/src/app/db-secret' , readOnly : 'true' }]",
        "kubernetes.limits.memory": "512Mi",
        "kubernetes.imagepullpolicy": "Always",
        "kubernetes.requests.memory": "512Mi",
        "kubernetes.livenessprobedelay": "120",
        "kubernetes.readinessprobedelay": "120"
    },
    "eventTypeName": "eventtype-1",
    "eventstoreType": "pg",
    "lastUpdated": 1574417165615,
    "_links": {
        "self": {
            "href": "https://hostname/projects/global/event-types/eventtype-1/eventstores/pg/persister"
        }
    }
}
```
{% endswagger-response %}

{% swagger-response status="401" description="Token invalid or missing." %}
```
{
    "timestamp": 1587302709982,
    "type": "authentication_error",
    "message": "Authentication failed.",
    "details": "uri=/projects/global/event-types/adobe-s3/eventstores/pg/persister"
}
```
{% endswagger-response %}

{% swagger-response status="403" description="Missing roles to access this resource." %}
```
{
    "timestamp":1586949273019,
    "type": "entity_not_accessible",
    "message": "Access forbidden due to missing roles.",
    "details":"uri=/projects/global/event-types/test-event-type-partial/eventstores/pg/persister"
}
```
{% endswagger-response %}

{% swagger-response status="404" description="Event store, event type not found (expected behaviour on event types other than of type "data_in")" %}
```
{
    "timestamp": 1587303625038,
    "type": "entity_not_found",
    "message": "Persister 'adobe-s3' not found.",
    "details": "uri=/projects/global/event-types/adobe-s3/eventstores/pg/persister"
}
```
{% endswagger-response %}
{% endswagger %}

{% swagger baseUrl="https://api.grnry.io" path="/projects/:project-name/event-types/:event-type-name/eventstores/pg/persister" method="put" summary="Update Persister Config for a Specific Event Type" conflict="[object Object]" %}
{% swagger-description %}
Updates the persister configuration of a specific event type.

\


This request requires the

`editor`

 role of the project.
{% endswagger-description %}

{% swagger-parameter in="path" name="project-name" type="string" %}
Name of project the event-type belongs to.

\




_Backwards compatibility:_

 

\


If 

`projects/{project-name}/`

 is missing, URL will be treated like 

`projects/global/...`

 scoping the request to the 'global' project.
{% endswagger-parameter %}

{% swagger-parameter in="path" name="event-type-name" type="string" required="true" %}
Name of the event type.
{% endswagger-parameter %}

{% swagger-parameter in="header" name="Authentication" type="string" required="true" %}
Authentication token.
{% endswagger-parameter %}

{% swagger-parameter in="query" name="imported" type="string" required="false" %}
If set to 

`"true"`

 (not case sensitive), the persister default values will be merged into the provided PUT body while keeping the custom values if provided.
{% endswagger-parameter %}

{% swagger-parameter in="body" name="deployerConfig" type="object" required="true" %}
A map containing all deployment configuration options.
{% endswagger-parameter %}

{% swagger-parameter in="body" name="appConfig" type="object" required="true" %}
A map containing all application configuration parameters.
{% endswagger-parameter %}

{% swagger-parameter in="body" name="appVersion" type="string" %}
The updated stream app version. This version has to be present in the backend spring cloud data flow server, otherwise the update will fail.
{% endswagger-parameter %}

{% swagger-response status="200" description="" %}
```
{
    "streamName": "grnry-p-pg-postman-eventtype-1",
    "projectName": "global",
    "appName": "grnry-eventstore-pg",
    "appVersion": "latest",
    "appConfig": {
        "eventstore.tableName": "public.eventstore",
        "spring.datasource.url": "jdbc:postgresql://grnry-pg-citus:5432/postgres?currentSchema=public",
        "spring.datasource.password": "${superuser-password}",
        "spring.datasource.username": "${superuser-username}",
        "spring.cloud.kubernetes.secrets.paths": "/usr/src/app/db-secret",
        "spring.cloud.stream.bindings.input.consumer.concurrency": "6",
        "spring.cloud.stream.bindings.input.consumer.partitioned": "true"
    },
    "deployerConfig": {
        "kubernetes.volumes": "[{name: 'secret', secret: { secretName : 'grnry-base-encryption-token' , defaultMode : '256' }}, {name: 'db-secret', secret: { secretName : 'grnry-pg-citus-secret' , defaultMode : '256' }}]",
        "kubernetes.limits.cpu": "700m",
        "kubernetes.requests.cpu": "700m",
        "kubernetes.volumeMounts": "[{name: 'secret', mountPath: '/usr/src/app/rsa_privatekey.key' , subPath: 'rsa_privatekey.key' , readOnly : 'true' },{name: 'secret', mountPath: '/usr/src/app/rsa_publickey.key' , subPath: 'rsa_publickey.key' , readOnly : 'true' }, {name: 'db-secret', mountPath: '/usr/src/app/db-secret' , readOnly : 'true' }]",
        "kubernetes.limits.memory": "512Mi",
        "kubernetes.imagePullPolicy": "Always",
        "kubernetes.requests.memory": "512Mi",
        "kubernetes.livenessProbeDelay": "120",
        "kubernetes.readinessProbeDelay": "120"
    },
    "eventTypeName": "postman-eventtype-1",
    "eventstoreType": "pg",
    "lastUpdated": 1574417943266,
    "_links": {
        "self": {
            "href": "https://hostname/projects/global/event-types/eventtype-1/eventstores/pg/persister?expand="
        }
    }
}
```
{% endswagger-response %}

{% swagger-response status="400" description="Invalid parameters" %}
```
{
    "timestamp": 1587302499600,
    "type": "bad_parameter_value",
    "message": "Parameter 'event_type_name' cannot be null",
    "details":"uri=/projects/global/event-types/event-type-empty-update-persister-config/eventstores/pg/persister"
}
```
{% endswagger-response %}

{% swagger-response status="401" description="Token invalid or missing." %}
```
{
    "timestamp": 1587302709982,
    "type": "authentication_error",
    "message": "Authentication failed.",
    "details": "uri=/projects/global/event-types/adobe-s3/eventstores/pg/persister"
}
```
{% endswagger-response %}

{% swagger-response status="403" description="Missing roles to access this resource." %}
```
{
    "timestamp":1586949273019,
    "type": "entity_not_accessible",
    "message": "Access forbidden due to missing roles.",
    "details":"uri=/projects/global/event-types/test-event-type-partial/eventstores/pg/persister"
}
```
{% endswagger-response %}

{% swagger-response status="404: Not Found" description="Entity not found." %}
```javascript
{
    "timestamp": 1587303625038,
    "type": "entity_not_found",
    "message": "Persister 'adobe-s3' not found.",
    "details": "uri=/projects/global/event-types/adobe-s3/eventstores/pg/persister"
}
```
{% endswagger-response %}
{% endswagger %}

{% swagger baseUrl="https://api.grnry.io" path="/projects/:project-name/event-types/:event-type-name/eventstores/pg/persister/state" method="get" summary="Get State of a Persister for a Specific Event Type" conflict="[object Object]" %}
{% swagger-description %}
Get the current state of a persister for an event type.

\


This request requires an 

`editor`

 or 

`viewer`

 role of the project.
{% endswagger-description %}

{% swagger-parameter in="path" name="project-name" type="string" %}
Name of project the event-type belongs to. 

\




_Backwards compatibility:_

 

\


If 

`projects/{project-name}/`

 is missing, URL will be treated like 

`projects/global/...`

 scoping the request to the 'global' project.
{% endswagger-parameter %}

{% swagger-parameter in="path" name="event-type-name" type="string" required="true" %}
Name of the event type.
{% endswagger-parameter %}

{% swagger-parameter in="header" name="Authentication" type="string" required="true" %}
Authentication token.
{% endswagger-parameter %}

{% swagger-response status="200" description="" %}
```
{
    "status": "STOPPED",
    "_links": {
        "self": {
            "href": "https://hostname/projects/global/event-types/eventtype-1/eventstores/pg/persister/state"
        }
    }
}
```
{% endswagger-response %}

{% swagger-response status="401" description="Token invalid or missing." %}
```
{
    "timestamp": 1587302709982,
    "type": "authentication_error",
    "message": "Authentication failed.",
    "details": "uri=/projects/global/event-types/adobe-s3/eventstores/pg/persister/state"
}
```
{% endswagger-response %}

{% swagger-response status="403" description="Missing roles to access this resource." %}
```
{
    "timestamp":1586949273019,
    "type": "entity_not_accessible",
    "message": "Access forbidden due to missing roles.",
    "details":"uri=/projects/global/event-types/test-event-type-partial/eventstores/pg/persister/state"
}
```
{% endswagger-response %}

{% swagger-response status="404" description="Event store, event type not found." %}
```
{
    "timestamp": 1587303625038,
    "type": "entity_not_found",
    "message": "Persister 'adobe-s3' not found.",
    "details": "uri=/projects/global/event-types/adobe-s3/eventstores/pdg/persister/state"
}
```
{% endswagger-response %}
{% endswagger %}

Possible values for the status attribute in the response body are:

| STOPPING  | persister is being stopped            |
| --------- | ------------------------------------- |
| STOPPED   | persister is not deployed             |
| DEPLOYING | persister is being deployed           |
| RUNNING   | persister is running                  |
| FAILED    | persister is deployed but not running |

{% swagger baseUrl="https://api.grnry.io" path="/projects/:project-name/event-types/:event-type-name/eventstores/pg/persister/state" method="post" summary="Start/Stop Persister for a Specific Event Type" conflict="[object Object]" %}
{% swagger-description %}
Start or stop the state of a persister for an event type.

\


This request requires the  

`editor`

 role of the project.
{% endswagger-description %}

{% swagger-parameter in="path" name="project-name" type="string" %}
Name of project the event-type belongs to.

\




_Backwards compatibility:_

 

\


If 

`projects/{project-name}/`

 is missing, URL will be treated like 

`projects/global/...`

 scoping the request to the 'global' project.
{% endswagger-parameter %}

{% swagger-parameter in="path" name="event-type-name" type="string" required="true" %}
Name of the event type.
{% endswagger-parameter %}

{% swagger-parameter in="header" name="Authentication" type="string" required="true" %}
Authentication token.
{% endswagger-parameter %}

{% swagger-parameter in="body" name="action" type="string" required="true" %}
Updates the status of this persister. Possible values: 

`START`

 , 

`STOP`
{% endswagger-parameter %}

{% swagger-response status="200" description="" %}
```
{
    "status": "DEPLOYING",
    "_links": {
        "self": {
            "href": "https://hostname/projects/global/event-types/eventtype-1/eventstores/pg/persister/state"
        }
    }
}
```
{% endswagger-response %}

{% swagger-response status="400: Bad Request" description="" %}
```javascript
{
    "timestamp": 1635778655364,
    "message": "Parameter 'action' was assigned an invalid value, provided value: ''.",
    "type": "bad_parameter_value",
    "traceId": "4995123058748313916",
    "invalidParams": [
        {
            "type": "Parameter",
            "name": "action",
            "reason": "was assigned an invalid value, provided value: ''"
        }
    ],
    "details": "uri=/projects/testfordocu/event-types/dbt-belt-input-ET/eventstores/pg/persister/state"
}
```
{% endswagger-response %}

{% swagger-response status="401" description="Token invalid or missing." %}
```
{
    "timestamp": 1587302709982,
    "type": "authentication_error",
    "message": "Authentication failed.",
    "details": "uri=/projects/global/event-types/adobe-s3/eventstores/pg/persister/state"
}
```
{% endswagger-response %}

{% swagger-response status="403" description="Missing roles to access this resource." %}
```
{
    "timestamp":1586949273019,
    "type": "entity_not_accessible",
    "message": "Access forbidden due to missing roles.",
    "details":"uri=/projects/global/event-types/test-event-type-partial/eventstores/pg/persister/state"
}
```
{% endswagger-response %}

{% swagger-response status="404" description="Event store, event type not found." %}
```
{
     "timestamp": 1587303625038,
     "type": "entity_not_found",
     "message": "Persister 'adobe-s3' not found.",
     "details": "uri=/projects/global/event-types/adobe-s3/eventstores/pdg/persister/logs"
}
```
{% endswagger-response %}
{% endswagger %}

{% swagger baseUrl="https://api.grnry.io" path="/projects/:project-name/event-types/:event-type-name/eventstores/pg/persister/logs" method="get" summary="Get Persister Logs for a Specific Event Type" conflict="[object Object]" %}
{% swagger-description %}
Get the logs from a persister of an event type.

\


This request requires the 

`editor`

 or 

`viewer`

 role of the project.
{% endswagger-description %}

{% swagger-parameter in="path" name="project-name" type="string" %}
Name of project the event-type belongs to. 

\




_Backwards compatibility:_

 

\


If 

`projects/{project-name}/`

 is missing, URL will be treated like 

`projects/global/...`

 scoping the request to the 'global' project.
{% endswagger-parameter %}

{% swagger-parameter in="path" name="event-type-name" type="string" required="true" %}
Name of the event-type
{% endswagger-parameter %}

{% swagger-parameter in="header" name="Authentication" type="string" required="true" %}
Authentication token.
{% endswagger-parameter %}

{% swagger-parameter in="query" name="lines" type="integer" %}
The last x lines of the log (if available).

\


Valid value are : 

`1 .. 500`

. Default: 

`500`

.
{% endswagger-parameter %}

{% swagger-response status="200" description="" %}
```
{
    "logs": [
        "2021-08-16 12:30:22.156  INFO [g-p-pg-event-type-sink,,,] 1 --- [-write-health-1] o.a.k.c.c.internals.AbstractCoordinator  : [Consumer clientId=healthindicator-kafka2d1310a3-f25f-420f-8e81-e2cb71ec8218, groupId=healthindicator-kafka-36959226-28ea-4571-b7f1-386d05e2a21d] (Re-)joining group",
        "2021-08-16 12:31:22.156  INFO [g-p-pg-event-type-sink,,,] 1 --- [-write-health-1] o.a.k.c.c.internals.AbstractCoordinator  : [Consumer clientId=healthindicator-kafka2d1310a3-f25f-420f-8e81-e2cb71ec8218, groupId=healthindicator-kafka-36959226-28ea-4571-b7f1-386d05e2a21d] (Re-)joining group"
    ]
}
```
{% endswagger-response %}
{% endswagger %}
